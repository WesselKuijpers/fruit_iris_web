<button id="upload-button">Make Prediction</button>
<input type="file" style="display: none" id="upload-input">
<p id="result"></p>

<script src="https://code.jquery.com/jquery-2.2.4.js"></script>
<script>
    $("#upload-button").on("click", function() {
        $("#upload-input").trigger("click");
    });

    $("#upload-input").on("change", function(){
        filename = $("#upload-input").val()
        if(filename.includes(".jpg") || filename.includes(".png")) {
            sendData()
        } else {
            alert("Please provide an image in either .jpg or .png format.")
        }
    })

    function sendData() {
        document.getElementById("result").innerHTML = "<img src='{{ url_for('static', filename='img/spinner.gif') }}'>"

        let input = document.getElementById('upload-input')
        let files = input.files

        if (files.length) {
            let settings = {
                async: true,
                crossDomain: false,
                processData: false,
                contentType: false,
                type: 'POST',
                url: "/predict/",
                mimeType: 'multipart/form-data'
            }

            let formData = new FormData()
            formData.append("image", files[0])
            settings.data = formData

            $.ajax(settings).done(function(response){
                let decodedResponse = JSON.parse(response)
                document.getElementById("result").innerHTML = decodedResponse
            })
        }
    }
</script>
